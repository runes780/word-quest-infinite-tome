# Word Quest: Infinite Tome 路线图（2026）

> 基线日期：2026-02-08  
> 适用对象：产品、研发、教学设计、数据分析  
> 当前版本：v1.1-dev（学习闭环与数据一致性已完成第一轮）

---

## 1. 路线图目标

### 北极星目标
- 在不牺牲趣味性的前提下，提升学习效果与留存质量。
- 将“游戏行为”与“学习行为”统一进入可解释的数据闭环。

### 年度优先级（由高到低）
1. 学习效果（正确复习、正确评估、正确干预）
2. 稳定性与一致性（离线、容错、可恢复）
3. 留存与动机（任务线、节奏感、可达成）
4. 家校协同（报告可执行、建议可追踪）

---

## 2. 阶段规划

## Phase 0（已完成，截止 2026-02-08）
### 目标
- 修复主学习闭环中的关键一致性问题。

### 已交付
- 题目协议升级（`questionMode`/`correctAnswer`/`skillTag`/`difficulty` 统一兜底）
- `typing/fill-blank` 错误答案污染修复
- `learningEvents` 统一事件流水（battle/srs/daily）
- `updatePlayerProfile` 支持原子增量与 mastery delta
- OpenRouter 全局共享限速调度器（free/paid 分流）
- 成就弹窗链路接通
- OCR 文案与真实能力对齐（演示模式）

### 退出标准
- 单测通过
- 类型检查通过
- 关键链路（战斗/复习/每日挑战）均有学习事件落库

---

## Phase 1（2026-02-09 ~ 2026-02-23）
### 主题
学习效果强化（Mastery Engine v1）

### 目标
- 将“正确率”升级为“掌握度状态机”并驱动题目与奖励策略。

### 范围
- In:
  - 掌握度状态机（新学/学习中/巩固/精通）
  - 基于掌握度的题目调度
  - 导师触发从“连续错”升级为“高价值错因”
- Out:
  - 账号体系、云同步、社交功能

### 具体任务
1. 数据模型
- 在 `db.ts` 新增 `skill_mastery` 或等效聚合表
- 建立技能维度衰减与晋升规则（按 `learningEvents` 聚合）

2. 题目调度
- 将 `reorderBySkill` 扩展为“掌握度 + 最近错因 + 到期复习”三因子排序
- 对低掌握技能提升曝光但限制连续惩罚（避免挫败）

3. 导师策略
- 触发条件改为：
  - 高难技能错误
  - 重复错因（近 N 次同类误区）
  - FSRS 高风险到期卡错误
- 输出结构增加“错因标签 + 下一步行动”
- 家长面板增加“连续高强度干预预警”（基于定向复习连续低正确率轮次）

4. 奖励策略
- 奖励从“单题对错”部分迁移到“技能进步事件”
- 新增“技能晋级奖励”与“复习保留奖励”

### 验收标准
- 7 天复习命中率提升（目标 +8%）
- 同一错因重复率下降（目标 -20%）
- 题型分布符合 50/30/20（连续 100 题抽样）
- 高强度预警可识别连续低质量定向复习并提示减负策略

### 风险与依赖
- 风险：早期 mastery 震荡导致体验不稳定
- 缓解：设最小样本阈值与平滑窗口

---

## Phase 2（2026-02-24 ~ 2026-03-20）
### 主题
游戏化深化（Learning Questline v1）

### 目标
- 成就系统从“静态徽章”升级到“学习任务线”。

### 当前进展（2026-02-08）
- 已落地“周任务线 v0”：任务实体（目标/进度/期限/奖励/证据）、`learningEvents` 自动进度消费、家长面板任务线可视化、每日挑战自动计入任务。

### 范围
- In:
  - 学习任务线（时态周、词汇冲刺周、阅读推理周）
  - 每日挑战纳入统一成长主线
  - 目标型奖励替代部分随机奖励
- Out:
  - PvP 实时对战

### 具体任务
1. 任务线系统
- 新增任务实体：目标、进度、期限、奖励、完成证据
- 任务与 `learningEvents` 自动关联更新

2. 每日挑战整合
- 每日挑战完成度计入任务线
- 挑战结果写入家长面板的长期趋势

3. 奖励重构
- 降低纯随机掉落权重
- 增加“完成关键学习行为”奖励（复习完成、弱点突破）

### 当前进展（2026-02-08，续）
- 已落地奖励保底：Boss 结算采用“金币+碎片+功能奖励”保底组合，未收集遗物时保证遗物掉落，收集满后自动转为功能药水。
- 已落地目标奖励：任务结算新增“复习完成奖励（SRS）”与“弱点突破奖励（accuracy/attempt 阈值）”，并写入玩家成长数据。
- 已落地验收看板：家长面板新增参与率/任务完成率/次日留存三指标，对比上一窗口并给出达标状态。

### 验收标准
- 次日留存提升（目标 +5%）
- 每日挑战参与率提升（目标 +15%）
- 任务完成率 > 60%

### 风险与依赖
- 风险：任务过多造成认知负担
- 缓解：同屏最多展示 3 个活跃任务

---

## Phase 3（2026-03-21 ~ 2026-04-10）
### 主题
家校协同与可解释性（Guardian Intelligence v1）

### 目标
- 家长/教师面板从“展示数据”升级到“给出可执行建议”。

### 当前进展（2026-02-08）
- 已落地“今晚复习计划 v0”：建议卡（题量/时长/证据）+ 优先级（紧急/重要/可选）+ 执行回写（完成/跳过）+ 14 天执行率统计。

### 范围
- In:
  - 建议卡（今晚复习什么、做几题、预计时长）
  - 证据链（错题样本、FSRS 到期原因、建议来源）
  - 周报导出结构优化

### 具体任务
1. 建议引擎
- 基于 `learningEvents + skill mastery + FSRS due` 生成建议
- 建议附带优先级、预估时长、达成条件

2. 证据链
- 每条建议绑定证据：
  - 最近错题
  - 到期卡
  - 技能趋势图

3. 报告产出
- 导出模板增加“行动计划 vs 实际完成”
- 增加“过去 7/14/30 天对比”

### 验收标准
- 家长面板周活提升（目标 +20%）
- 建议执行率（点击后完成）> 40%

### 风险与依赖
- 风险：建议过于泛化
- 缓解：建议必须绑定至少 1 条证据链

---

## Phase 4（2026-04-11 ~ 2026-05-15）
### 主题
平台化与扩展能力（Foundation for Scale）

### 目标
- 为后续账号体系、班级协作、多端同步打好基础。

### 范围
- In:
  - 领域模型整理（store slice 拆分、数据访问层抽象）
  - E2E 自动化（学习主流程）
  - 性能与可观测性基线
- Out:
  - 完整 B2B 管理后台（仅设计接口）

### 具体任务
1. 架构清理
- `BattleInterface`、`gameStore` 按领域拆分
- 学习域（Learning）、游戏域（Combat）、经济域（Economy）解耦

2. 测试体系
- 新增 E2E：生成任务 -> 战斗 -> 复习 -> 报告导出
- 数据一致性回归测试（事件、画像、面板）

3. 性能与稳定性
- 离线缓存策略评估
- 关键路径监控（响应时间、失败率、重试率）

### 验收标准
- 主流程 E2E 全绿
- 高并发下限速稳定，无 429 风暴
- 关键页面交互延迟下降

---

## 3. 版本里程碑（建议）

- v1.2（2026-02-23）：Mastery Engine v1
- v1.3（2026-03-20）：Learning Questline v1
- v1.4（2026-04-10）：Guardian Intelligence v1
- v1.5（2026-05-15）：Scale Foundation

---

## 4. 关键验收矩阵（跨阶段）

1. 学习效果
- 7 天复测正确率
- 弱点技能改善率
- 重复错因下降率

2. 行为质量
- 每日挑战参与率
- 任务完成率
- 复习到期完成率

3. 系统可靠性
- API 调用失败率
- 数据一致性（事件-画像-报表）
- 会话恢复成功率

---

## 5. 协作机制

- 周节奏：每周一冻结目标、周三中检、周五验收
- 文档约定：路线图更新在 `ROADMAP.md`，执行项在 `TODO.md`
- 变更原则：任何功能上线前必须有验收指标与回归测试
